<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>shell :: KASUSA</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="自学shell脚本" />
<meta name="keywords" content=", " />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://kasusa.github.io/hugo/post/shell/" />




<link rel="stylesheet" href="https://kasusa.github.io/hugo/assets/style.css">






<link rel="apple-touch-icon" href="https://kasusa.github.io/hugo/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://kasusa.github.io/hugo/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="shell">
<meta property="og:description" content="自学shell脚本" />
<meta property="og:url" content="https://kasusa.github.io/hugo/post/shell/" />
<meta property="og:site_name" content="KASUSA" />

  <meta property="og:image" content="https://kasusa.github.io/hugo/">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-05-29 00:00:00 &#43;0000 UTC" />












</head>
<body class="">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/hugo/">
    <div class="logo">
        KASUSA
    </div>
</a>
    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/hugo/links">中转站</a></li>
        
      
        
          <li><a href="/hugo/contact">交个朋友</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/hugo/links">中转站</a></li>
      
    
      
        <li><a href="/hugo/contact">交个朋友</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://kasusa.github.io/hugo/post/shell/">shell</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-05-29 
      </span>
    
    
    <span class="post-author">:: kasusa</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://kasusa.github.io/hugo/tags/ubuntu/">ubuntu</a>&nbsp;
    
    #<a href="https://kasusa.github.io/hugo/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/">命令行</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <p><a href="https://www.runoob.com/linux/linux-shell-variable.html">菜鸟shell教程</a></p>
<h1 id="shell-命令脚本">Shell 命令脚本<a href="#shell-命令脚本" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Shell 脚本文件的名称可以任意，建议将.sh 后缀加上，以表示是一个脚本文件。</p>
<ol>
<li>创建脚本：<code>vim example.sh</code></li>
<li>写好脚本的内容（就是连串的shell语句）</li>
<li>执行脚本：（后面的是参数）
<ul>
<li><code> bash example.sh</code></li>
<li><code>sh example.sh</code></li>
<li><code>./example.sh </code> （一般会有权限不足的报错，升权限就好了）</li>
</ul>
</li>
</ol>
<h2 id="简单的脚本">简单的脚本<a href="#简单的脚本" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span><span style="color:#75715e">#For Example BY linuxprobe.com</span>
pwd
ls -al
</code></pre></div><p>在上面的这个 example.sh 脚本中实际上出现了三种不同的元素：</p>
<ul>
<li>第一行的脚本声明（#!）用来告诉系统使用哪种 Shell 解释器来执行该脚本；</li>
<li>第二行的注释信息（#）是对脚本功能和某些命令的介绍信息，使得自己或他人在日后看到这个脚本内容时，可以快速知道该脚本的作用或一些警告信息；</li>
<li>第三、四行的可执行语句也就是我们平时执行的 Linux 命令了。</li>
</ul>
<h2 id="带参数的脚本-接收参数">带参数的脚本-接收参数<a href="#带参数的脚本-接收参数" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>如何运行带参数的脚本：</p>
<pre><code>sh example.sh one two three four five six
</code></pre><p>脚本内容：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>echo <span style="color:#e6db74">&#34;当前脚本名称为</span>$0<span style="color:#e6db74">&#34;</span>
echo <span style="color:#e6db74">&#34;总共有</span>$#<span style="color:#e6db74">个参数，分别是</span>$*<span style="color:#e6db74">。&#34;</span>
echo <span style="color:#e6db74">&#34;第 1 个参数为</span>$1<span style="color:#e6db74">，第 5 个为</span>$5<span style="color:#e6db74">。&#34;</span>
</code></pre></div><table>
<thead>
<tr>
<th>~</th>
<th>~</th>
</tr>
</thead>
<tbody>
<tr>
<td>$0</td>
<td>对应的是当前 Shell 脚本程序的名称，</td>
</tr>
<tr>
<td>$#</td>
<td>对应的是总共有几个参数</td>
</tr>
<tr>
<td>$*</td>
<td>对应的是所有位置的参数值</td>
</tr>
<tr>
<td>$?</td>
<td>对应的是显示上一次命令的执行返回值</td>
</tr>
<tr>
<td>$1、$2、$3</td>
<td>则分别对应着第 N 个位置的参数值</td>
</tr>
</tbody>
</table>
<h2 id="带参数的脚本-判断用户的参数">带参数的脚本-判断用户的参数<a href="#带参数的脚本-判断用户的参数" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>运算符</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-d</td>
<td>测试文件是否为目录类型</td>
</tr>
<tr>
<td>-e</td>
<td>测试文件是否存在</td>
</tr>
<tr>
<td>-f</td>
<td>判断是否为一般文件</td>
</tr>
<tr>
<td>-r</td>
<td>测试当前用户是否有权限读取</td>
</tr>
<tr>
<td>-w</td>
<td>测试当前用户是否有权限写入</td>
</tr>
<tr>
<td>-x</td>
<td>测试当前用户是否有权限执行</td>
</tr>
<tr>
<td>&mdash;</td>
<td>0代表存在，否则不存在</td>
</tr>
</tbody>
</table>
<p>例子： 下面使用文件测试语句来判断/etc/fstab 是否为一个目录类型的文件，然后通过 Shell 解释器的内设$?变量显示上一条命令执行后的返回值。</p>
<pre><code>root@KASUSA-cloud:~# [ -f mydir ]
root@KASUSA-cloud:~# echo $?
1
</code></pre><h2 id="符号符号"><code>&amp;&amp;</code>符号,<code>||</code>符号<a href="#符号符号" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<blockquote>
<p>&amp;&amp;，它表示当前面的命令执行成功后才会执行它后面的命令</p>
</blockquote>
<p>判断目录是否存在：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span> -e mydir <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;Exist&#34;</span>
</code></pre></div><blockquote>
<p>表示当前面的命令执行失败后才会执行它后面的命令，</p>
</blockquote>
<p>因此可以用来结合系统环境变量 USER 来判断当前登录的用户是否为非管理员身份：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#f92672">[</span> $USER <span style="color:#f92672">=</span> root <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;user&#34;</span>
</code></pre></div><p>一个复杂一点的判断用户的例子：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"> <span style="color:#f92672">[</span> ! $USER <span style="color:#f92672">=</span> root <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;user&#34;</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;root&#34;</span>
</code></pre></div><h2 id="运算比较符">运算比较符<a href="#运算比较符" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>运算符</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>-eq</td>
<td>是否等于</td>
</tr>
<tr>
<td>-ne</td>
<td>是否不等于</td>
</tr>
<tr>
<td>-gt</td>
<td>是否大于</td>
</tr>
<tr>
<td>-lt</td>
<td>是否小于</td>
</tr>
<tr>
<td>-le</td>
<td>是否等于或小于</td>
</tr>
<tr>
<td>-ge</td>
<td>是否大于或等于</td>
</tr>
</tbody>
</table>
<h2 id="流程控制语句">流程控制语句<a href="#流程控制语句" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<h3 id="if-条件测试语句">if 条件测试语句<a href="#if-条件测试语句" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p><img src="http://ww1.sinaimg.cn/large/0083vuQJly1gbmzfmixtrj30eh05t3z5.jpg" alt="if">
<img src="http://ww1.sinaimg.cn/large/0083vuQJly1gbmzhnsu8uj30g9074jsb.jpg" alt="if else if"></p>
<h3 id="for-条件循环语句">for 条件循环语句<a href="#for-条件循环语句" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p><img src="http://ww1.sinaimg.cn/large/0083vuQJly1gbmzpen0wwj30ev05fmxp.jpg" alt="for1"></p>
<p>批量创建用户脚本：
创建 user.txt</p>
<pre><code>vim users.txt
</code></pre><pre><code>andy
barry
carl
duke
eric
george
</code></pre><p>创建脚本 Example.sh</p>
<pre><code> vim Example.sh
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>read -p <span style="color:#e6db74">&#34;Enter The Users Password : &#34;</span> PASSWD
<span style="color:#66d9ef">for</span> UNAME in <span style="color:#e6db74">`</span>cat users.txt<span style="color:#e6db74">`</span>
  <span style="color:#66d9ef">do</span>
  id $UNAME &amp;&gt; /dev/null
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
      <span style="color:#66d9ef">then</span>
        echo <span style="color:#e6db74">&#34;Already exists&#34;</span>
      <span style="color:#66d9ef">else</span>
        useradd $UNAME &amp;&gt; /dev/null
        echo <span style="color:#e6db74">&#34;</span>$PASSWD<span style="color:#e6db74">&#34;</span> | passwd --stdin $UNAME &amp;&gt; /dev/null
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $? -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
          <span style="color:#66d9ef">then</span>
            echo <span style="color:#e6db74">&#34;</span>$UNAME<span style="color:#e6db74"> , Create success&#34;</span>
          <span style="color:#66d9ef">else</span>
            echo <span style="color:#e6db74">&#34;</span>$UNAME<span style="color:#e6db74"> , Create failure&#34;</span>
        <span style="color:#66d9ef">fi</span>
    <span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">done</span>

</code></pre></div><blockquote>
<p>需要多说一句，/dev/null 是一个被称作 Linux 黑洞的文件，把输出信息重定向到这个文件等同于删除数据（类似于没有回收功能的垃圾箱），可以让用户的屏幕窗口保持简洁。</p>
</blockquote>
<h3 id="while-条件循环语句">while 条件循环语句<a href="#while-条件循环语句" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>执行前并不确定最终执行的次数</p>
<p><img src="http://ww1.sinaimg.cn/large/006rgJELly1gbwy6ok0x4j306q04874d.jpg" alt="sshot-2020-02-15-[1].png"></p>
<p>例子：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span><span style="color:#75715e">#在CASE变量小于等于20的时候一直运行</span>
CASE<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>                  <span style="color:#75715e">#初始化变量</span>
echo <span style="color:#e6db74">&#34;case = </span>$CASE<span style="color:#e6db74">&#34;</span>     <span style="color:#75715e">#显示变量</span>
<span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span> $CASE -le <span style="color:#ae81ff">20</span> <span style="color:#f92672">]</span>  <span style="color:#75715e">#while条件</span>
<span style="color:#66d9ef">do</span>                      <span style="color:#75715e">#while开始</span>
CASE<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>expr $CASE + 1<span style="color:#e6db74">`</span>   <span style="color:#75715e">#相当于CASE++</span>
echo <span style="color:#e6db74">&#34;case = </span>$CASE<span style="color:#e6db74">&#34;</span>     <span style="color:#75715e">#显示下CASE的值</span>
<span style="color:#66d9ef">done</span>                    <span style="color:#75715e">#结束</span>
</code></pre></div>
      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">看看别的</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://kasusa.github.io/hugo/post/hugo-newblog/">
                <span class="button__icon">←</span>
                <span class="button__text">hugo博客</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://kasusa.github.io/hugo/post/ubuntu-install-java/">
                <span class="button__text">ubuntu上安装java</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://kasusa.github.io/hugo/assets/main.js"></script>
<script src="https://kasusa.github.io/hugo/assets/prism.js"></script>







  
</div>

</body>
</html>
